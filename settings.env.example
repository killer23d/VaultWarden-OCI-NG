# VaultWarden-OCI-NG Environment Configuration
# This file contains non-sensitive settings. Docker Compose will load it as .env.
# Sensitive values (passwords, tokens) belong in secrets/secrets.yaml.

# --- Core Project Configuration ---
PROJECT_STATE_DIR=/var/lib/vaultwarden
COMPOSE_PROJECT_NAME=vaultwarden
TZ=UTC

# --- Application Configuration ---
# Your public domain name WITHOUT protocol (e.g., vault.example.com)
# Caddy will handle HTTPS automatically.
DOMAIN=vault.example.com
# Email address for admin notifications and Let's Encrypt registration
ADMIN_EMAIL=admin@example.com

# Database URL (using SQLite in the persistent volume)
DATABASE_URL=sqlite:///data/db.sqlite3

# Feature Toggles (Optimized for small teams)
SIGNUPS_ALLOWED=false         # Disable public signups
INVITATIONS_ALLOWED=true      # Allow admins to invite users
WEBSOCKET_ENABLED=true        # Enable WebSocket for real-time client sync (Requires port 3012 in Caddy/Compose)
PUSH_ENABLED=false            # Set to true ONLY if you configure push notification secrets in secrets.yaml

# Logging
LOG_LEVEL=warn                # Options: trace, debug, info, warn, error
EXTENDED_LOGGING=true         # Log more details like IP addresses

# --- OCI A1 Flex Resource Limits (1 OCPU, 6GB RAM) ---
# Adjusted limits for the target environment.
VAULTWARDEN_MEMORY_LIMIT=1.5G
VAULTWARDEN_MEMORY_RESERVATION=256M
CADDY_MEMORY_LIMIT=384M
CADDY_MEMORY_RESERVATION=64M
FAIL2BAN_MEMORY_LIMIT=192M
FAIL2BAN_MEMORY_RESERVATION=64M
WATCHTOWER_MEMORY_LIMIT=128M
WATCHTOWER_MEMORY_RESERVATION=32M
DDCLIENT_MEMORY_LIMIT=64M
DDCLIENT_MEMORY_RESERVATION=16M

# --- Backup Retention ---
BACKUP_KEEP_DB=14             # Keep last 14 daily database backups (by date)
BACKUP_KEEP_FULL=4            # Keep last 4 weekly full backups (by date)
# Size-based cleanup is also applied via backup-monitor.sh (target <40% disk usage)

# --- Watchtower (Update Monitoring) ---
# Schedule is now handled externally by cron/systemd timer running 'docker compose run --rm watchtower'
# WATCHTOWER_SCHEDULE=0 0 5 * * 1 # Example: Every Monday at 5 AM (No longer needed in run-once mode)
WATCHTOWER_CLEANUP=true         # Remove old images after check
WATCHTOWER_NOTIFICATIONS=email  # Notify via email

# --- Dynamic DNS (Optional) ---
# Set DDCLIENT_ENABLED=true and configure secrets in secrets.yaml to enable
DDCLIENT_ENABLED=false
DDCLIENT_PROTOCOL=cloudflare    # Ensure this matches your provider
DDCLIENT_LOGIN=               # Your Cloudflare email or relevant login
DDCLIENT_ZONE=example.com       # Your root domain registered with Cloudflare/provider
DDCLIENT_HOST=vault             # The subdomain part for Vaultwarden (e.g., vault.example.com)
